<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Sunda Nuswantara OS - Panel Persamaan Nilai Komoditas</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #050505; color: #00ffcc; padding: 20px; }
        .container { max-width: 1500px; margin: auto; border: 5px solid #00ffcc; padding: 30px; box-shadow: 0 0 50px rgba(0, 255, 204, 0.2); }
        h1 { text-align: center; color: #fff; text-transform: uppercase; letter-spacing: 3px; margin-bottom: 5px; }
        .sub-header { text-align: center; color: #ffcc00; font-size: 1.2em; margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 15px; }

        /* Dashboard Utama */
        .dash-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .dash-card { background: #111; border: 3px solid #ffcc00; padding: 20px; text-align: center; }
        .card-label { text-transform: uppercase; font-size: 0.9em; color: #aaa; margin-bottom: 10px; }
        .card-val { font-size: 2.2em; font-weight: bold; color: #fff; }

        /* Tabel Persamaan */
        table { width: 100%; border-collapse: collapse; background: #0d0d0d; font-size: 18px; margin-top: 20px; }
        th, td { border: 2px solid #333; padding: 15px; text-align: left; }
        th { background: #1a1a1a; color: #00ffcc; text-transform: uppercase; text-align: center; }
        .price-col { text-align: right; color: #ff4d4d; font-weight: bold; }
        .dirham-col { text-align: center; background: #1a1a00; color: #ffcc00; font-weight: bold; font-size: 1.2em; border: 2px solid #ffcc00; }
        
        /* Panel Barter Mufakat */
        .barter-box { margin-top: 40px; border: 3px solid #ffcc00; background: rgba(255, 204, 0, 0.05); padding: 25px; }
        .barter-title { color: #fff; font-size: 1.8em; text-transform: uppercase; text-align: center; border-bottom: 2px solid #ffcc00; padding-bottom: 10px; margin-bottom: 25px; }
        .barter-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
        .barter-row { display: flex; align-items: center; justify-content: space-around; background: #1a1a1a; padding: 15px; border-radius: 8px; font-size: 1.4em; border: 1px solid #333; }
        .item-box { flex: 1; text-align: center; font-weight: bold; }
        .equals-sign { flex: 0.2; text-align: center; color: #ffcc00; font-size: 1.5em; }
        .highlight { color: #00ffcc; }

        #status-bar { text-align: center; padding: 10px; margin-bottom: 20px; border: 2px dashed #ffcc00; color: #ffcc00; font-weight: bold; }
        .footer-note { margin-top: 30px; padding: 20px; border-left: 10px solid #ffcc00; background: rgba(255, 204, 0, 0.05); color: #fff; line-height: 1.6; }
        
        .updated-flash { animation: flash-green 1s; }
        @keyframes flash-green { 0% { color: #fff; } 100% { color: inherit; } }
    </style>
</head>
<body>

<div class="container">
    <h1>PANEL PERSAMAAN NILAI KOMODITAS</h1>
    <div class="sub-header">PROTOKOL RECOVERY EKONOMI MIKRO - SUNDA NUSWANTARA OS</div>

    <div id="status-bar">MENGHUBUNGKAN KE DATA SP2KP KEMENDAG & JANGKAR INDUK...</div>

    <div class="dash-grid">
        <div class="dash-card">
            <div class="card-label">Anchor Harga 1 Dinar (Induk)</div>
            <div class="card-val" id="dinar-idr">Rp ---</div>
        </div>
        <div class="dash-card" style="border-color: #00ffcc;">
            <div class="card-label" style="color: #00ffcc;">Persamaan 1 Dirham Perak</div>
            <div class="card-val" id="dirham-idr" style="color: #00ffcc;">Rp ---</div>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Daftar Komoditas (Nasional)</th>
                <th>Harga Per Kuantitas (IDR)</th>
                <th>Persamaan Nilai (Per 1 Dirham)</th>
            </tr>
        </thead>
        <tbody id="commodity-table"></tbody>
    </table>

    <div class="barter-box">
        <div class="barter-title">Persamaan Antar Nilai (Barter Mufakat)</div>
        <div class="barter-grid" id="barter-simulation">
            </div>
        <p style="text-align: center; color: #aaa; margin-top: 20px; font-style: italic;">
            *Simulasi di atas adalah kesetaraan murni berdasarkan berat emas/perak. Pertukaran dapat dilakukan langsung tanpa uang kertas/koin fisik bila ada kesepakatan saling ridho.
        </p>
    </div>

    <div class="footer-note">
        <strong>PANDUAN TRANSAKSI MIKRO:</strong><br>
        Tabel di atas menggunakan <strong>Harga Jangkar Dirham</strong> sebagai tolok ukur "Isi" barang. Jika harga Rupiah naik (Inflasi), jumlah barang per 1 Dirham akan tetap stabil atau bahkan bertambah, menjaga produsen tidak rugi dan konsumen tetap mampu beli. <br>
        <em>Data Referensi: SP2KP Kemendag Januari 2026 (Rata-Rata Nasional).</em>
    </div>
</div>

<script>
    const baseLow = 2400.00; 
    const gramPerOz = 31.1035;
    const beratDinar = 4.25;
    const ratioDinarDirham = 27;

    const sp2kpData = [
        { name: "Beras Premium", price: 16500, unit: "Kg" },
        { name: "Beras Medium", price: 14200, unit: "Kg" },
        { name: "Gula Konsumsi", price: 18500, unit: "Kg" },
        { name: "Minyak Goreng (Minyakita)", price: 15700, unit: "Liter" },
        { name: "Daging Sapi (Paha Belakang)", price: 142500, unit: "Kg" },
        { name: "Daging Ayam Ras", price: 38900, unit: "Kg" },
        { name: "Telur Ayam Ras", price: 31200, unit: "Kg" },
        { name: "Bawang Merah", price: 45930, unit: "Kg" },
        { name: "Bawang Putih (Honan)", price: 39763, unit: "Kg" },
        { name: "Cabai Merah Keriting", price: 58000, unit: "Kg" },
        { name: "Tepung Terigu", price: 13500, unit: "Kg" }
    ];

    async function updateValueEquality() {
        try {
            const goldRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=pax-gold&vs_currencies=usd');
            const goldData = await goldRes.json();
            const goldSpotUSD = goldData['pax-gold'].usd;

            const idrRes = await fetch('https://open.er-api.com/v6/latest/USD?t=' + Date.now());
            const idrData = await idrRes.json();
            const rateIDR = idrData.rates.IDR;

            const goldMidAnchorUSD = (baseLow + goldSpotUSD) / 2;
            const priceDinarIDR = (goldMidAnchorUSD / gramPerOz) * beratDinar * rateIDR;
            const priceDirhamIDR = priceDinarIDR / ratioDinarDirham;

            document.getElementById('dinar-idr').innerText = "Rp " + priceDinarIDR.toLocaleString('id-ID', {maximumFractionDigits: 0});
            document.getElementById('dirham-idr').innerText = "Rp " + priceDirhamIDR.toLocaleString('id-ID', {maximumFractionDigits: 0});

            // 1. Render Tabel Utama
            let html = "";
            let qtyMap = {}; // Simpan data untuk barter
            sp2kpData.forEach(item => {
                const qtyPerDirham = priceDirhamIDR / item.price;
                qtyMap[item.name] = { qty: qtyPerDirham, unit: item.unit };
                html += `
                    <tr>
                        <td><strong>${item.name}</strong></td>
                        <td class="price-col">Rp ${item.price.toLocaleString('id-ID')} / ${item.unit}</td>
                        <td class="dirham-col">${qtyPerDirham.toFixed(2)} ${item.unit}</td>
                    </tr>
                `;
            });
            document.getElementById('commodity-table').innerHTML = html;

            // 2. Render Simulasi Barter (Persamaan Antar Nilai)
            // Kita buat 3 contoh barter yang sering terjadi di desa
            const barterSim = [
                { item1: "Beras Premium", item2: "Daging Sapi (Paha Belakang)" },
                { item1: "Telur Ayam Ras", item2: "Daging Ayam Ras" },
                { item1: "Beras Medium", item2: "Cabai Merah Keriting" }
            ];

            let barterHtml = "";
            barterSim.forEach(pair => {
                const data1 = qtyMap[pair.item1];
                const data2 = qtyMap[pair.item2];
                barterHtml += `
                    <div class="barter-row">
                        <div class="item-box">
                            <span class="highlight">${data1.qty.toFixed(2)} ${data1.unit}</span> ${pair.item1}
                        </div>
                        <div class="equals-sign">â‡Œ</div>
                        <div class="item-box">
                            <span class="highlight">${data2.qty.toFixed(2)} ${data2.unit}</span> ${pair.item2}
                        </div>
                    </div>
                `;
            });
            document.getElementById('barter-simulation').innerHTML = barterHtml;

            document.getElementById('status-bar').innerText = `SINKRONISASI AKTIF | JANGKAR: $${goldMidAnchorUSD.toFixed(2)} | HARGA DIRHAM: Rp ${Math.round(priceDirhamIDR).toLocaleString('id-ID')}`;

        } catch (e) {
            document.getElementById('status-bar').innerText = "KONEKSI SP2KP/API TERPUTUS...";
        }
    }

    setInterval(updateValueEquality, 30000);
    updateValueEquality();
</script>
</body>
</html>