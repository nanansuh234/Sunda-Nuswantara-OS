<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Nuswantara Explorer - Fixed Connection</title>
    <style>
        :root {
            --win-blue: #0078d7;
            --bg-main: #ffffff;
            --sidebar-bg: #f3f3f3;
            --border: #d2d2d2;
            --text: #333;
            --taskbar-bg: #f0f0f0;
            --hover: #e5e5e5;
        }

        body.dark-mode {
            --bg-main: #1a1a1a;
            --sidebar-bg: #252525;
            --border: #444;
            --text: #e0e0e0;
            --taskbar-bg: #111;
            --hover: #333;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, sans-serif;
            margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }

        /* --- TOOLBAR --- */
        .toolbar {
            height: 40px; background: var(--bg-main); border-bottom: 1px solid var(--border);
            display: flex; align-items: center; padding: 0 10px; gap: 10px;
        }
        .btn-nav { background: none; border: none; font-size: 1.1rem; cursor: pointer; color: var(--win-blue); }
        .btn-nav:disabled { color: #ccc; cursor: default; }
        .address-bar { 
            flex: 1; border: 1px solid var(--border); padding: 4px 10px; 
            font-size: 0.85rem; color: #666; background: var(--bg-main);
        }
        .search-box {
            width: 250px; border: 1px solid var(--border); padding: 4px 10px;
            display: flex; align-items: center; gap: 8px; background: var(--bg-main);
        }

        /* --- LAYOUT --- */
        .explorer-container { display: flex; flex: 1; overflow: hidden; position: relative; }
        
        .sidebar { 
            width: 230px; background: var(--sidebar-bg); 
            border-right: 1px solid var(--border); font-size: 0.85rem;
            padding-top: 10px;
        }

        .nav-group { 
            margin: 5px 10px 15px 10px; 
            border: 1px solid var(--border); 
            border-radius: 4px;
            overflow: hidden;
        }
        .nav-title { padding: 5px 15px; font-weight: bold; font-size: 0.75rem; color: #666; background: rgba(0,0,0,0.03); }
        .nav-item { 
            padding: 6px 15px; display: flex; align-items: center; 
            gap: 10px; cursor: pointer; transition: 0.1s;
        }
        .nav-item:hover { background: var(--hover); }
        .nav-item.active { background: #cce8ff !important; color: #000 !important; border-left: 3px solid var(--win-blue); }

        .explorer-view { flex: 1; padding: 20px; overflow-y: auto; }

        .view-section-title { font-size: 0.9rem; margin-bottom: 15px; color: var(--win-blue); border-bottom: 1px solid var(--border); padding-bottom: 5px; }
        .grid-layout { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; }
        .item-card { display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; padding: 10px; border-radius: 4px; }
        .item-card:hover { background: #cce8ff; }
        .item-icon { font-size: 2.5rem; margin-bottom: 5px; }
        .item-label { font-size: 0.7rem; font-weight: 500; }

        /* --- TASKBAR & POPUP --- */
        .taskbar {
            height: 45px; background: var(--taskbar-bg); border-top: 1px solid var(--border);
            display: flex; align-items: center; padding: 0 10px; z-index: 2000;
        }
        .start-btn {
            background: var(--win-blue); color: #fff; border: none;
            padding: 8px 18px; font-weight: bold; border-radius: 3px; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
        }

        #startMenuPopup {
            display: none; position: fixed; bottom: 50px; left: 10px;
            width: 220px; background: var(--bg-main); border: 2px solid var(--win-blue);
            box-shadow: 0 0 20px rgba(0,0,0,0.3); border-radius: 8px; z-index: 9999;
        }
        .menu-item {
            padding: 12px 15px; font-size: 0.85rem; cursor: pointer;
            display: flex; align-items: center; gap: 10px; border-bottom: 1px solid var(--border);
        }
        .menu-item:hover { background: var(--win-blue); color: #fff; }

        .theme-mode-btn {
            margin-left: auto; cursor: pointer; font-size: 0.85rem;
            display: flex; align-items: center; gap: 5px; color: var(--text);
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="toolbar">
        <div style="display:flex; gap:5px;">
            <button class="btn-nav" id="btnBack" onclick="goBack()" disabled>‚¨Ö</button>
            <button class="btn-nav" id="btnForward" onclick="goForward()" disabled>‚û°</button>
        </div>
        <div class="address-bar" id="pathDisp">üìÅ This PC > Devices and drives</div>
        <div class="search-box">
            üîç <input type="text" placeholder="Search Index..." oninput="search(this.value)" style="border:none; outline:none; background:none; width:100%; color:inherit;">
        </div>
    </div>

    <div class="explorer-container">
        <div class="sidebar">
            <div class="nav-group">
                <div class="nav-title">Quick access</div>
                <div class="nav-item" id="nav-all" onclick="navigate('apps', 'all', true, this)">‚≠ê All Applications</div>
                <div class="nav-item" onclick="parent.showDashboard()">üñ•Ô∏è Desktop</div>
            </div>

            <div class="nav-group">
                <div class="nav-title">This PC</div>
                <div class="nav-item active" id="nav-root" onclick="navigate('root', 'all', true, this)">üíª This PC</div>
                <div class="nav-item" id="nav-time" onclick="navigate('apps', 'cat-time', true, this)" style="padding-left:35px;">üìÅ Waktu & Kala</div>
                <div class="nav-item" id="nav-nature" onclick="navigate('apps', 'cat-nature', true, this)" style="padding-left:35px;">üìÅ Alat & Tabib</div>
                <div class="nav-item" id="nav-fin" onclick="navigate('apps', 'cat-fin', true, this)" style="padding-left:35px;">üìÅ Ekonomi Nilai</div>
            </div>
        </div>

        <div class="explorer-view">
            <div id="driveView">
                <div class="view-section-title">Devices and drives (2)</div>
                <div class="grid-layout">
                    <div class="item-card" onclick="navigate('apps', 'all', true, document.getElementById('nav-all'))">
                        <div class="item-icon">üíæ</div>
                        <div class="item-label">System (C:)</div>
                    </div>
                    <div class="item-card" onclick="navigate('apps', 'cat-future', true, null)">
                        <div class="item-icon">üíæ</div>
                        <div class="item-label">Arsip Data (E:)</div>
                    </div>
                </div>
            </div>

            <div id="appView" class="hidden">
                <div class="view-section-title" id="folderTitle">Applications</div>
                <div class="grid-layout" id="appGrid"></div>
            </div>
        </div>
    </div>

    <div id="startMenuPopup">
        <div style="background:var(--win-blue); color:white; padding:10px; font-weight:bold; font-size:0.8rem;">NUSWANTARA EXPLORER</div>
        <div class="menu-item" onclick="parent.showDashboard(); toggleStart();"><span>üñ•Ô∏è</span> Go to Desktop</div>
        <div class="menu-item" onclick="parent.closeAllApps(); toggleStart();"><span>üßπ</span> Clear RAM / Close All</div>
        <div class="menu-item" onclick="location.reload();"><span>üîÑ</span> Refresh Explorer</div>
    </div>

    <div class="taskbar">
        <button class="start-btn" onclick="toggleStart()">
            <span>üí†</span> START
        </button>
        <div class="theme-mode-btn" onclick="toggleTheme()">
            <span id="themeIcon">üåì</span> Theme Mode
        </div>
    </div>

    <script>
        // Database aplikasi sinkron dengan index.html
const appDatabase = [
    { url: 'Readme.html', label: 'Tentang', icon: '‚ÑπÔ∏è', cat: 'cat-blue' },
    { url: '01 Jam Sunda Nuswantara.html', label: 'Jam Utama', icon: 'üïê', cat: 'cat-time' },
    { url: '02. Kalender Sunda Nuswantara.html', label: 'Kalender', icon: 'üìÖ', cat: 'cat-time' },
    { url: '03. Jadwal Shalat Sunda Nuswantara.html', label: 'Shalat', icon: 'üïå', cat: 'cat-time' },
    { url: '04. Converter Waktu & Tanggal Ke Sunda Nuswantara.html', label: 'Konverter', icon: 'üîÑ', cat: 'cat-sys' },
    { url: '05. Satuan Nilai Sunda Nuswantara.html', label: 'Satuan Nilai', icon: '‚öñÔ∏è', cat: 'cat-sys' },
    { url: '06. Contoh Jadwal Kegiatan Sunda Nuswantara.html', label: 'Jadwal', icon: 'üìù', cat: 'cat-blue' },
    { url: '07. Panduan Manual Contoh Pertanian.html', label: 'Lumbung', icon: 'üåæ', cat: 'cat-nature' },
    { url: '08. Panduan Manual Contoh Produktifitas dan Karya.html', label: 'Karya', icon: 'üî®', cat: 'cat-nature' },
    { url: '09. Aksara Hanacaraka.html', label: 'Hanacaraka', icon: 'Í¶≤', cat: 'cat-culture' },
    { url: '10. Aksara Sunda Kuno.html', label: 'Sunda Kuno', icon: '·Æä', cat: 'cat-culture' },
    { url: '11. Rekonstruksi Bahasa Sunda Kuno.html', label: 'Kamus', icon: 'üìñ', cat: 'cat-lingo' },
    { url: '12. Sunda Kuno.html', label: 'Olaxara', icon: '‚úíÔ∏è', cat: 'cat-lingo' },
    { url: 'Tools.html', label: 'Logic Engine', icon: 'üß†', cat: 'cat-nature' },
    { url: '13. Kumpulan Renungan.html', label: 'Renungan', icon: 'üìö', cat: 'cat-lingo' },
    { url: '14. Terapi Cahaya Malam.html', label: 'Terapi Sirep', icon: 'üïØÔ∏è', cat: 'cat-sys' },
    { url: '15. Appraisal Scanner.html', label: 'Appraisal', icon: 'üîç', cat: 'cat-doc' },
    { url: '16. Restorasi Pangan.html', label: 'Teknologi Pangan', icon: 'üçØ', cat: 'cat-nature' },
    { url: '17. Restorasi Arsitektur.html', label: 'Arsitektur', icon: 'üõñ', cat: 'cat-nature' },
    { url: '18. Restorasi Kesehatan.html', label: 'Tabib Digital', icon: 'üåø', cat: 'cat-nature' },
    { url: '19. Restorasi Wastra.html', label: 'Wastra Alam', icon: 'üß∂', cat: 'cat-culture' },
    { url: '20. Restorasi Sosial.html', label: 'Balai Warga', icon: 'ü§ù', cat: 'cat-sys' },
    { url: '21. Pustaka Peradaban.html', label: 'Leveling Diri', icon: '‚è´', cat: 'cat-lingo' },
    { url: '23. Scanner Nilai Dasar.html', label: 'Analisa Dasar', icon: 'üîç', cat: 'cat-doc' },
    { url: '24. Estafet Kemanusiaan.html', label: 'Codex Manusia', icon: 'üë§', cat: 'cat-human' },
    { url: '25. Menu Ekonomi.html', label: 'Ekonomi Nilai', icon: 'üí∞', cat: 'cat-fin' },
    { url: '26. Menu Masa Depan.html', label: 'Realitas & Masa Depan', icon: 'üíä', cat: 'cat-future' },
    { url: '27. Menu Hukum Syariat dan Hakikat.html', label: 'Syariat & Hakikat', icon: '‚öñÔ∏è', cat: 'cat-edu' },
    { url: '28. Indikator Iman.html', label: 'Iman Metric', icon: 'üì∂', cat: 'cat-tools' },
    { url: '29. Pustaka Ajaran Tauhid.html', label: 'Pustaka Ajaran Tauhid', icon: 'üìÑ', cat: 'cat-doc' },
    { url: '30. Quantum Vitality.html', label: 'Quantum Vitality', icon: '‚öõÔ∏è', cat: 'cat-future' },
    { url: '31. Holistic Calibration.html', label: 'Holistic Radar', icon: 'üì°', cat: 'cat-edu' },
    { url: '32. Legacy Hub.html', label: 'Warisan Generasi', icon: 'üå≥', cat: 'cat-fin' },
    { url: '33. Civilization Hub.html', label: 'Civilization Hub', icon: 'üåç', cat: 'cat-future' },
    { url: '34.Nusantara Auto-Anchor (POS Mode).html', label: 'Auto-Anchor POS', icon: '‚öì', cat: 'cat-future' },
    { url: '35.Nusantara Savings Simulator.html', label: 'Simulasi Tabungan', icon: 'üí∞', cat: 'cat-fin' },
    { url: '36.Nusantara Income Generator.html', label: 'Income Generator', icon: 'üî®', cat: 'cat-fin' },
    { url: '37. Pusat Strategi Ekonomi.html', label: 'Pusat Strategi Ekonomi', icon: 'ü§ù', cat: 'cat-sys' },
    { url: '37. Jam Pasir Timer.html', label: 'Jam Pasir Nusantara', icon: '‚è≥', cat: 'cat-sys' },
    { url: '38. Kawi Jawa Kuno.html', label: 'Prasasti Jawa Kawi', icon: 'üóø', cat: 'cat-sys' },
    { url: '39. Pagon Mataram.html', label: 'Mesin Ketik Pegon', icon: '‚úíÔ∏è', cat: 'cat-sys' },
    { url: '40. Encoder Arsip Keraton.html', label: 'Encoder Arsip Keraton', icon: '‚úíÔ∏è', cat: 'cat-sys' },
    { url: '41. Ancient Astronomy.html', label: 'Ancient Astronomy', icon: 'üïê', cat: 'cat-sys' },
    { url: '42. Advanced Systems.html', label: 'Advanced Systems', icon: '‚öõÔ∏è', cat: 'cat-future' },
    { url: '43. Forbidden Tech.html', label: 'Forbidden Tech', icon: '‚öõÔ∏è', cat: 'cat-future' },
    { url: '44. Gallery.html', label: 'Gallery', icon: 'üñºÔ∏è', cat: 'cat-tech' },
    { url: '45. Media Player.html', label: 'Media Player', icon: 'üéµ', cat: 'cat-time' },
    { url: '46. TV Jadul.html', label: 'TV Jadul', icon: 'üì∫', cat: 'cat-tech' },
    { url: '54. Double Anchor System.html', label: 'Double Anchor System', icon: '‚öñÔ∏è', cat: 'cat-doc' },
    { url: '55. Nilai Komoditas.html', label: 'Daftar Nilai Komoditas', icon: 'üìö', cat: 'cat-fin' },
    { url: '56. Sunda Nuswantara Archive.html', label: 'SUNDA NUSWANTARA ARCHIVE', icon: 'üìñ', cat: 'cat-fin' },
    { url: '62. Menu Ether Tech.html', label: 'ETHER TECH & BLUEPRINTS', icon: '‚ö°', cat: 'cat-fin' },
    { url: 'kompas.html', label: 'NAVIGASI TAKTIS', icon: 'üß≠', cat: 'cat-fin' },
    { url: 'petajalur.html', label: 'BUAT PETA JALUR', icon: 'üåç', cat: 'cat-fin' },
    { url: 'DecentralizedID.html', label: 'Cetak Data Personal', icon: 'üìÑ', cat: 'cat-fin' },
    { url: 'WAenigma.html', label: 'WAenigma', icon: '‚úíÔ∏è', cat: 'cat-fin' },
    { url: 'Picmigma.html', label: 'Picmigma', icon: 'üîç', cat: 'cat-fin' },
    { url: 'morsenigma.html', label: 'Morsenigma', icon: 'üîä', cat: 'cat-fin' },
    { url: 'stegavault.html', label: 'Stegavault', icon: 'üóø', cat: 'cat-fin' },
    { url: 'sonicmind.html', label: 'Sonicmind', icon: 'üîä', cat: 'cat-fin' },
    { url: 'sonicmindtransfer.html', label: 'Sonic Mind Transfer', icon: 'üîä', cat: 'cat-fin' },
    { url: 'https://unorganically-flangeless-parthenia.ngrok-free.dev/', label: 'Genesis Chat', icon: 'üí¨', cat: 'cat-human' },
    { url: 'genesis manager.html', label: 'Genesis Local File Manager', icon: 'üìÇ', cat: 'cat-human' },
    { url: 'mtfzonetradingsystem.html', label: 'MTF Zone Trading System', icon: 'üìà', cat: 'cat-human' },
    { url: 'Nmail.html', label: 'N-Mail', icon: '‚úâÔ∏è', cat: 'cat-human' },
    { url: 'SMS.html', label: 'Inbox SMS', icon: 'üìÇ', cat: 'cat-human' },
    { url: '56. Nuswantara Hub.html', label: 'Nuswantara Hub & Tools', icon: 'üë§', cat: 'cat-human' },
    { url: 'Bio Medic.html', label: 'Bio Medic Hacking', icon: 'üíä', cat: 'cat-future' },
    { url: 'Khusus Insan Dewasa Baligh.html', label: 'Dewasa Baligh', icon: '‚ù§Ô∏è‚Äçüî•', cat: 'cat-future' }
];

        let historyStack = [{target: 'root', cat: 'all'}];
        let curIdx = 0;

        // FUNGSI UTAMA UNTUK MEMBUKA APLIKASI DI PANEL UTAMA
        function openAppInOS(url, label, icon) {
            // Kita coba berbagai cara untuk mencapai parent.launchApp
            if (typeof parent.launchApp === "function") {
                parent.launchApp(url, label, icon);
            } else if (window.parent && typeof window.parent.launchApp === "function") {
                window.parent.launchApp(url, label, icon);
            } else {
                console.error("Gagal terhubung ke Nuswantara OS utama.");
                window.open(url, '_blank');
            }
        }

        function navigate(target, cat = 'all', push = true, navEl = null) {
            const dv = document.getElementById('driveView');
            const av = document.getElementById('appView');
            const path = document.getElementById('pathDisp');
            const grid = document.getElementById('appGrid');

            if(navEl) {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                navEl.classList.add('active');
            }

            if (target === 'root') {
                dv.classList.remove('hidden'); av.classList.add('hidden');
                path.innerText = "üìÅ This PC > Devices and drives";
            } else {
                dv.classList.add('hidden'); av.classList.remove('hidden');
                path.innerText = `üìÅ This PC > Apps > ${cat}`;
                grid.innerHTML = "";
                const filtered = cat === 'all' ? appDatabase : appDatabase.filter(a => a.cat === cat);
                filtered.forEach(app => {
                    grid.innerHTML += `<div class="item-card" onclick="openAppInOS('${app.url}','${app.label}','${app.icon}')">
                        <div class="item-icon">${app.icon}</div><div class="item-label">${app.label}</div>
                    </div>`;
                });
            }

            if (push) {
                historyStack = historyStack.slice(0, curIdx + 1);
                historyStack.push({target, cat});
                curIdx++;
            }
            updateBtns();
        }

        function goBack() { 
            if(curIdx > 0) { 
                curIdx--; 
                let s = historyStack[curIdx]; 
                let el = (s.target === 'root') ? document.getElementById('nav-root') : null;
                navigate(s.target, s.cat, false, el); 
            } 
        }

        function goForward() { 
            if(curIdx < historyStack.length - 1) { 
                curIdx++; 
                let s = historyStack[curIdx]; 
                navigate(s.target, s.cat, false); 
            } 
        }
        
        function updateBtns() {
            document.getElementById('btnBack').disabled = curIdx === 0;
            document.getElementById('btnForward').disabled = curIdx === historyStack.length - 1;
        }

        function toggleStart() {
            const m = document.getElementById('startMenuPopup');
            m.style.display = (m.style.display === 'block') ? 'none' : 'block';
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            document.getElementById('themeIcon').innerText = isDark ? '‚òÄÔ∏è' : 'üåì';
        }

        function search(q) {
            if(q.length > 0) navigate('apps', 'all', false);
            document.querySelectorAll('.item-card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q.toLowerCase()) ? 'flex' : 'none';
            });
        }

        window.addEventListener('click', (e) => {
            if (!e.target.closest('.start-btn') && !e.target.closest('#startMenuPopup')) {
                document.getElementById('startMenuPopup').style.display = 'none';
            }
        });
    </script>
</body>
</html>
