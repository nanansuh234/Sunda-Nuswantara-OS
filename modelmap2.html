<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUSWANTARA: ORGANIC SPHERE PROJECTION</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #000;
            --ice: #e3f2fd;
            --gold: #ffaa00;
            --deep-sea: #001133;
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Share Tech Mono', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        h1 {
            position: absolute; top: 10px;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 170, 0, 0.6);
            letter-spacing: 5px;
            font-size: 20px;
            z-index: 50;
        }

        /* CONTAINER UTAMA */
        .viewport {
            position: relative;
            width: 90vw;
            height: 80vh;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        /* LAPISAN MASKING (BENTUK LENSA/MATA) */
        .globe-lens {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            /* Ini kuncinya: Border Radius bikin sudut tumpul, bukan kotak */
            border-radius: 50%; 
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.1);
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: var(--deep-sea);
        }

        /* GAMBAR PETA */
        .map-layer {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 100%; height: 100%;
            /* Peta Resolusi Tinggi */
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Equirectangular-projection.jpg/1920px-Equirectangular-projection.jpg');
            background-position: center center;
            background-repeat: repeat-x;
            /* Transisi halus saat di-zoom */
            transition: background-size 0.1s ease-out, background-position 0.1s ease-out;
            
            /* Efek Kedalaman (Vignette) */
            box-shadow: inset 0 0 100px 50px rgba(0,0,0,0.8);
        }

        /* DINDING ES (ATAS & BAWAH) */
        /* Kita pakai Pseudo-elements untuk bikin efek es melengkung menutup */
        .globe-lens::before, .globe-lens::after {
            content: '';
            position: absolute;
            left: -10%; right: -10%; /* Lebih lebar biar lengkungan halus */
            height: 50%;
            background: linear-gradient(to bottom, #fff 10%, #aaddff 50%, transparent 100%);
            z-index: 10;
            border-radius: 50%; /* Bikin melengkung */
            transition: all 0.2s ease-out;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.5));
        }

        /* ES ATAS (ARKTIK) */
        .globe-lens::before {
            top: -35%; /* Posisi awal ngumpet dikit */
            background: linear-gradient(to bottom, var(--ice) 40%, transparent 100%);
        }

        /* ES BAWAH (ANTARTIKA) */
        .globe-lens::after {
            bottom: -35%;
            background: linear-gradient(to top, var(--ice) 40%, transparent 100%);
        }

        /* HUD & GRID */
        .grid-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.8) 100%);
            pointer-events: none;
            z-index: 5;
            mix-blend-mode: multiply;
        }
        
        .center-marker {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 20px; height: 20px;
            border: 1px solid var(--gold);
            border-radius: 50%;
            z-index: 20;
            box-shadow: 0 0 15px var(--gold);
        }

        /* CONTROLS */
        .control-panel {
            position: absolute; bottom: 20px;
            background: rgba(10, 10, 10, 0.9);
            padding: 15px 25px;
            border: 1px solid #333;
            border-radius: 50px;
            display: flex;
            gap: 30px;
            z-index: 100;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .input-group {
            display: flex; flex-direction: column; align-items: center;
        }

        label {
            font-size: 10px; color: var(--gold); margin-bottom: 5px; text-transform: uppercase;
        }

        input[type=range] {
            accent-color: var(--gold);
            cursor: pointer;
            width: 150px;
        }

    </style>
</head>
<body>

    <h1>NUSWANTARA: SPHERICAL ENCLOSURE</h1>

    <div class="viewport">
        <div class="globe-lens" id="lens">
            <div class="map-layer" id="map"></div>
            <div class="grid-overlay"></div>
            <div class="center-marker"></div>
        </div>
    </div>

    <div class="control-panel">
        <div class="input-group">
            <label>POSISI (PANNING)</label>
            <input type="range" id="panX" min="0" max="200" value="28" step="0.1">
        </div>
        <div class="input-group">
            <label>SKALA NUSWANTARA (ZOOM)</label>
            <input type="range" id="zoomLevel" min="100" max="300" value="130">
        </div>
        <div class="input-group">
            <label style="color:#00ccff">CRUNCH ES (LENGKUNGAN)</label>
            <input type="range" id="crunch" min="0" max="48" value="15">
        </div>
    </div>

    <script>
        const lens = document.getElementById('lens');
        const map = document.getElementById('map');
        const panX = document.getElementById('panX');
        const zoomLevel = document.getElementById('zoomLevel');
        const crunch = document.getElementById('crunch');

        // Stylesheet rule manipulation untuk pseudo-elements (Es Atas Bawah)
        // Kita butuh cara dinamis ngatur posisi ::before dan ::after
        // Cara termudah: pakai CSS Variables di element parent
        
        function updateMap() {
            // 1. PANNING & ZOOM
            const x = panX.value;
            const z = zoomLevel.value;
            
            map.style.backgroundPosition = `${x}% center`;
            map.style.backgroundSize = `auto ${z}%`; // Zoom vertikal & horizontal ngikut rasio

            // 2. CRUNCH (LENGKUNGAN BOLA)
            const c = crunch.value; 
            
            // Mengubah bentuk kotak jadi lonjong (mata)
            // Nilai 50% membuat lingkaran penuh. Nilai 0% kotak.
            // Kita mainkan border-radius sudutnya.
            
            // Saat c naik, tinggi container "dipencet" (opsional), 
            // tapi yang penting es-nya turun.
            
            // Update CSS Variables untuk posisi Es
            // Kita inject style langsung karena pseudo-element susah diakses via JS biasa
            const iceOffset = 35 - (c * 0.8); // Hitungan: makin besar crunch, makin kecil offset (makin masuk ke tengah)
            
            // Trik JS update CSS sheet
            const styleElem = document.head.querySelector('#dynamic-styles') || document.createElement('style');
            styleElem.id = 'dynamic-styles';
            styleElem.innerHTML = `
                .globe-lens::before { top: -${iceOffset}%; border-radius: 50% / ${100 - c}%; }
                .globe-lens::after { bottom: -${iceOffset}%; border-radius: 50% / ${100 - c}%; }
                .globe-lens { border-radius: ${c}% / 50%; } 
            `;
            document.head.appendChild(styleElem);
        }

        panX.addEventListener('input', updateMap);
        zoomLevel.addEventListener('input', updateMap);
        crunch.addEventListener('input', updateMap);
        
        // Init
        updateMap();
    </script>

</body>
</html>