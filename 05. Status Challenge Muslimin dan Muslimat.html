<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spirit System: Sufi Pathway</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #050a05; --card: #0d1a0d; --border: #1b331b; --text: #e1eee1; --primary: #2ecc71; --gold: #f1c40f; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', Tahoma, sans-serif; display: flex; justify-content: center; padding: 20px; }
        .app-container { background: var(--card); border: 2px solid var(--primary); border-radius: 20px; padding: 25px; width: 100%; max-width: 900px; box-shadow: 0 0 30px rgba(46, 204, 113, 0.1); }
        .header { display: flex; justify-content: space-between; border-bottom: 2px solid var(--border); padding-bottom: 15px; margin-bottom: 20px; }
        .main-content { display: flex; flex-wrap: wrap; gap: 20px; }
        .chart-box { flex: 1; min-width: 300px; background: #000; padding: 15px; border-radius: 15px; border: 1px solid var(--border); text-align: center; }
        .quest-box { flex: 1.2; min-width: 320px; display: flex; flex-direction: column; gap: 10px; }
        .tab-btn { border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.75rem; text-transform: uppercase; color: #000; transition: 0.3s; }
        .tab-btn:hover { transform: translateY(-2px); opacity: 0.9; }
        .tab-active { box-shadow: 0 0 15px currentColor; border: 2px solid #fff; }
        .task-list { background: #000; border: 1px solid var(--border); border-radius: 10px; padding: 15px; height: 400px; overflow-y: auto; }
        .task-item { display: flex; align-items: flex-start; gap: 10px; background: #122412; padding: 12px; border-radius: 8px; margin-bottom: 8px; font-size: 0.9rem; border: 1px solid transparent; cursor: pointer; }
        .task-item:hover { border-color: var(--primary); }
        input[type="checkbox"] { transform: scale(1.3); cursor: pointer; margin-top: 3px; }
        .gacha-btn { width: 100%; background: var(--gold); color: #000; border: none; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 10px; font-size: 1rem; }
        .status-msg { margin-top: 15px; font-size: 0.85rem; color: var(--gold); font-style: italic; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <div>
            <div style="font-size: 0.7rem; color: var(--primary); letter-spacing: 3px;">SALIK NAVIGATOR</div>
            <h2 id="hero-class" style="margin: 5px 0; color: #fff;">PENCARI JALAN</h2>
            <div id="hero-title" style="font-size: 0.85rem; color: var(--gold);">Maqam: Yaqazah (Sadar)</div>
        </div>
        <div style="text-align: right;">
            <div style="font-size: 0.7rem; color: #8b949e;">IMAN SYNC:</div>
            <div id="total-sync" style="font-size: 2.2rem; font-weight: bold; color: var(--primary);">0%</div>
        </div>
    </div>

    <div class="main-content">
        <div class="chart-box">
            <canvas id="radarChart"></canvas>
            <div id="log-box" class="status-msg">"Awaluddin Makrifatullah - Awal agama adalah mengenal Allah."</div>
        </div>

        <div class="quest-box">
            <button class="gacha-btn" onclick="gachaQuest()">✨ AMBIL RIYADHAH HARIAN</button>
            <div style="display: flex; gap: 5px; flex-wrap: wrap;" id="tab-container"></div>
            <div class="task-list">
                <h4 id="tab-title" style="margin: 0 0 12px 0;">PILIH MANAJEMEN QALBU</h4>
                <div id="task-items"></div>
            </div>
        </div>
    </div>
</div>

<script>
const db = {
    syariat: { label: 'Syariat', color: '#2ecc71', quests: [
        "Shalat tepat waktu (Awal Waktu)", "Jaga Wudhu seharian (Daimul Wudhu)", "Shalat Sunnah Rawatib min 2 rakaat", "Puasa Sunnah / Makan tidak berlebih", "Membaca Al-Qur'an min 10 Ayat", "Shalat Tahajud / Witir malam ini", "Menutup Aurat dengan sempurna & rapi", "Meninggalkan makanan Syubhat/Haram", "Istighfar 100x (Pembersihan Lisan)", "Zikir pagi & petang (Al-Ma'tsurat)"
    ]},
    tarekat: { label: 'Tarekat', color: '#27ae60', quests: [
        "Muraqabah: Diam 10 menit merasa diawasi Allah", "Muhasabah: Audit dosa sebelum tidur", "Zikir Sirr (Batin) saat beraktivitas", "Membaca Shalawat 100x (Mahabbah)", "Meredam amarah saat dipancing emosi", "Meninggalkan debat yang tidak perlu", "Mengurangi bicara hal yang sia-sia", "Ikhlas saat tidak dihargai manusia", "Sabar menghadapi satu kesulitan hari ini", "Taubat Nasuha atas satu kesalahan"
    ]},
    hakikat: { label: 'Hakikat', color: '#16a085', quests: [
        "Melihat Allah di balik setiap kejadian", "Yakin bahwa semua adalah ketetapan-Nya", "No Fomo: Dunia hanya panggung sandiwara", "Syukur atas nafas yang masih diberikan", "Ridha atas hasil yang tidak sesuai rencana", "Merasa butuh Allah dalam setiap detik", "Memahami bahwa diri ini adalah 'Nol'", "Tawakkal total setelah usaha maksimal", "Melihat hikmah di balik musibah", "Kondisi hati selalu terikat pada Sang Pencipta"
    ]},
    darma: { label: 'Akhlak', color: '#27ae60', quests: [
        "Jujur dalam transaksi/bisnis", "Tepat janji pada manusia & Allah", "Tidak berbohong meski untuk bercanda", "Menghormati orang tua (Birrul Walidain)", "Integritas: Sama antara lahir & batin", "Memaafkan kesalahan orang lain", "Rendah hati (Tawadhu) no-pamer kesalihan", "Malu melakukan maksiat saat sendiri", "Tanggung jawab atas amanah/pekerjaan", "Meninggalkan sifat hasad & iri hati"
    ]},
    silih: { label: 'Ukhuwah', color: '#1abc9c', quests: [
        "Sedekah sembunyi-sembunyi (Sirr)", "Membantu urusan 1 orang teman", "Menyingkirkan gangguan di jalan", "Mendoakan orang lain tanpa sepengetahuan mereka", "Menyambung silaturahmi (Chat/Tlp)", "Memberi makan hewan/menanam pohon", "Menjaga lisan dari ghibah/fitnah", "Memberi senyum & salam pada sesama", "Berbagi ilmu yang bermanfaat", "Meringankan beban keluarga/orang rumah"
    ]},
    karya: { label: 'Khidmah', color: '#f1c40f', quests: [
        "Niatkan kerja sebagai ibadah harian", "Mencari rezeki yang Halalan Thayyiban", "Membantu ekonomi orang yang susah", "Profesional: Bekerja dengan Itqan (Sempurna)", "Menghindari Riba dalam finansial", "Menggunakan Cuan untuk jalan dakwah/sosial", "Ciptakan solusi bagi masalah umat", "Tidak lalai ibadah karena pekerjaan", "Zakat & Infaq dari hasil keringat sendiri", "Bangun legacy yang bermanfaat jariyah"
    ]}
};

let userStats = JSON.parse(localStorage.getItem('sufi_v1_stats')) || { syariat: [], tarekat: [], hakikat: [], darma: [], silih: [], karya: [] };
let chart;

function init() {
    const tabContainer = document.getElementById('tab-container');
    tabContainer.innerHTML = "";
    Object.keys(db).forEach(key => {
        const btn = document.createElement('button');
        btn.className = `tab-btn btn-${key}`;
        btn.style.backgroundColor = db[key].color;
        btn.innerText = db[key].label;
        btn.onclick = () => switchTab(key);
        tabContainer.appendChild(btn);
    });
    renderChart();
    switchTab('syariat');
}

function switchTab(key) {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('tab-active'));
    document.querySelector(`.btn-${key}`).classList.add('tab-active');
    document.getElementById('tab-title').innerText = "RIYADHAH " + db[key].label.toUpperCase();
    document.getElementById('tab-title').style.color = db[key].color;
    const list = document.getElementById('task-items');
    list.innerHTML = "";
    db[key].quests.forEach((q, i) => {
        const checked = userStats[key].includes(i);
        const item = document.createElement('div');
        item.className = "task-item";
        item.onclick = () => toggleTask(key, i);
        item.innerHTML = `<input type="checkbox" ${checked ? 'checked' : ''} onclick="event.stopPropagation(); toggleTask('${key}', ${i})"><span style="${checked ? 'text-decoration:line-through; opacity:0.5' : ''}">${q}</span>`;
        list.appendChild(item);
    });
}

function toggleTask(key, idx) {
    if (userStats[key].includes(idx)) userStats[key] = userStats[key].filter(i => i !== idx);
    else userStats[key].push(idx);
    localStorage.setItem('sufi_v1_stats', JSON.stringify(userStats));
    updateUI();
    switchTab(key);
}

function updateUI() {
    const values = Object.keys(db).map(k => userStats[k].length);
    if (chart) { chart.data.datasets[0].data = values; chart.update(); }
    const sync = Math.round((values.reduce((a, b) => a + b, 0) / 60) * 100);
    document.getElementById('total-sync').innerText = sync + "%";
    
    const hClass = document.getElementById('hero-class');
    const hTitle = document.getElementById('hero-title');
    if (sync > 20) { hClass.innerText = "SALIK (PENDAKI)"; hTitle.innerText = "Maqam: Taubat"; }
    if (sync > 50) { hClass.innerText = "MUJAHID (PEJUANG)"; hTitle.innerText = "Maqam: Ridha"; }
    if (sync > 85) { hClass.innerText = "MUTTAQUIN"; hTitle.innerText = "Maqam: Makrifat"; }
}

function gachaQuest() {
    const keys = Object.keys(db);
    const k = keys[Math.floor(Math.random() * keys.length)];
    const q = db[k].quests[Math.floor(Math.random() * 10)];
    alert(`✨ RIYADHAH HARIAN:\n\n[${db[k].label}] : ${q}\n\nLakukan dengan niat Lillahi Ta'ala!`);
}

function renderChart() {
    const ctx = document.getElementById('radarChart').getContext('2d');
    chart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: Object.keys(db).map(k => db[k].label),
            datasets: [{
                label: 'Spirit Level',
                data: Object.keys(db).map(k => userStats[k].length),
                backgroundColor: 'rgba(46, 204, 113, 0.2)',
                borderColor: '#2ecc71',
                pointBackgroundColor: '#fff',
                borderWidth: 2
            }]
        },
        options: {
            scales: { r: { min: 0, max: 10, ticks: { display: false }, grid: { color: '#1b331b' }, angleLines: { color: '#1b331b' }, pointLabels: { color: '#e1eee1', font: { size: 11 } } } },
            plugins: { legend: { display: false } }
        }
    });
}
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>